<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114å¹´åº¦é†«äº‹è·é¡è«–æ–‡è©•é¸è¦–è¦ºåŒ–ç¶²é </title>
    <!-- è¼‰å…¥ Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- è¼‰å…¥ Noto Sans TC å­—é«” -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* è¨­å®šå…¨åŸŸå­—é«” */
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            background: linear-gradient(135deg, #fdfbf7 0%, #f4f0e6 100%);
            color: #374151;
            -webkit-font-smoothing: antialiased;
        }

        /* éš±è—å¯æ”¶åˆå…§å®¹ï¼Œç•¶è¢«é¸ä¸­æ™‚æ‰é¡¯ç¤º */
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease;
            opacity: 0;
        }
        
        .collapsible-toggle[aria-expanded="true"] + .collapsible-content {
            max-height: 2000px; /* è¶³å¤ å¤§çš„é«˜åº¦ä»¥å®¹ç´å…§å®¹ */
            opacity: 1;
        }

        .collapsible-toggle[aria-expanded="true"] .arrow-icon {
            transform: rotate(180deg);
        }

        .arrow-icon {
            transition: transform 0.3s ease;
        }

        /* è‡ªå®šç¾©æ»¾å‹•æ¢ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #d1d5db; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #9ca3af; 
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-6 lg:p-10">

    <div id="app" class="max-w-7xl mx-auto">
        <!-- æ¨™é¡Œå€åŸŸ -->
        <header class="text-center mb-10 md:mb-12 animate-fade-in-down">
            <h1 class="text-5xl md:text-7xl font-extrabold mb-4 tracking-tight">
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-purple-700 via-fuchsia-600 to-purple-700">114å¹´åº¦ é†«äº‹è·é¡è«–æ–‡è©•é¸</span>
            </h1>
        </header>

        <!-- ä¸»è¦å…§å®¹å€åŸŸ (å·¦å³åˆ†æ¬„) -->
        <main class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- å·¦å´æ¬„ä½: æ´»å‹•è³‡è¨Š (ä½” 4/12) -->
            <aside class="lg:col-span-4 space-y-6">
                
                <!-- ğŸ“‹ æ´»å‹•æ¦‚è¿° -->
                <div class="bg-white rounded-2xl shadow-lg border border-slate-100 overflow-hidden transform hover:-translate-y-1 transition-transform duration-300">
                    <div class="bg-slate-50 p-4 border-b border-slate-100 flex items-center">
                        <span class="text-2xl mr-3">ğŸ“‹</span>
                        <h2 class="text-xl font-bold text-slate-800">æ´»å‹•æ¦‚è¿°</h2>
                    </div>
                    <div class="p-6 space-y-4">
                        <!-- ç›®çš„ -->
                        <div class="flex items-start space-x-3">
                            <div class="bg-rose-50 p-2 rounded-lg text-rose-600 mt-1 shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                            </div>
                            <div>
                                <p class="text-sm font-bold text-slate-500 uppercase tracking-wide">ç›®çš„</p>
                                <p class="text-black leading-relaxed">
                                    ç‚ºé¼“å‹µé†«äº‹äººå“¡ç©æ¥µåƒèˆ‡é†«å­¸æœƒæ´»å‹•ï¼Œæ•™å­¸éƒ¨ç‰¹åˆ¥èˆ‰è¾¦æœ¬æ´»å‹•ï¼Œä»¥ä¿ƒé€²æ–°çŸ¥äº¤æµã€æå‡å­¸è¡“å“è³ªï¼Œä¸¦å±•ç¾å€‹äººå°ˆæ¥­åƒ¹å€¼ã€‚
                                </p>
                            </div>
                        </div>

                        <!-- æ”¶éŒ„æœŸé–“ -->
                        <div class="flex items-start space-x-3">
                            <div class="bg-blue-50 p-2 rounded-lg text-blue-600 mt-1 shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
                            </div>
                            <div>
                                <p class="text-sm font-bold text-slate-500 uppercase tracking-wide">æ”¶éŒ„æœŸé–“</p>
                                <p class="text-black font-medium leading-relaxed">113å¹´10æœˆ01æ—¥ ~ 114å¹´09æœˆ30æ—¥</p>
                            </div>
                        </div>
                        
                        <!-- å°è±¡ -->
                        <div class="flex items-start space-x-3">
                            <div class="bg-emerald-50 p-2 rounded-lg text-emerald-600 mt-1 shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                            </div>
                            <div>
                                <p class="text-sm font-bold text-slate-500 uppercase tracking-wide">å°è±¡</p>
                                <p class="text-black leading-relaxed">ç›®å‰åœ¨è·çš„å„é†«äº‹è·é¡ä»¥ç¬¬ä¸€ä½œè€…ç™¼è¡¨æ–¼å„é†«å­¸æœƒè€…ã€‚</p>
                            </div>
                        </div>

                        <!-- çµ„åˆ¥ -->
                        <div class="flex items-start space-x-3">
                            <div class="bg-purple-50 p-2 rounded-lg text-purple-600 mt-1 shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z" /></svg>
                            </div>
                            <div>
                                <p class="text-sm font-bold text-slate-500 uppercase tracking-wide">çµ„åˆ¥</p>
                                <p class="text-black leading-relaxed">
                                    å…±7çµ„ï¼Œè—¥äº‹çµ„ã€é†«äº‹æ”¾å°„çµ„ã€é†«äº‹æª¢é©—çµ„ã€è­·ç†çµ„ã€ç‡Ÿé¤Šçµ„ã€å‘¼å¸æ²»ç™‚çµ„åŠè½åŠ›/ç‰©ç†æ²»ç™‚/è·èƒ½æ²»ç™‚/è‡¨åºŠå¿ƒç†/èªè¨€æ²»ç™‚çµ„ã€‚
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ğŸ“… ç™¼è¡¨æœƒ/æµ·å ±å±•ç¤ºå€ -->
                <div class="space-y-4">
                    <!-- è«–æ–‡ç™¼è¡¨æœƒ å¡ç‰‡ -->
                    <div class="bg-white p-5 rounded-2xl shadow-md border-l-4 border-red-500 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 opacity-10 transform translate-x-4 -translate-y-4 group-hover:scale-110 transition-transform">
                            <span class="text-9xl">ğŸ¤</span>
                        </div>
                        <h3 class="text-lg font-bold text-red-700 mb-2 flex items-center relative z-10">
                            <span class="mr-2">ğŸ¤</span>è«–æ–‡ç™¼è¡¨æœƒ
                        </h3>
                        <p class="text-red-500 text-lg font-bold uppercase tracking-wider mb-3">â˜… é‚€è«‹å„çµ„ç¬¬ä¸€åå£é ­åˆ†äº« â˜…</p>
                        <div class="text-black text-base space-y-1 relative z-10">
                            <p><strong>æ—¥æœŸ:</strong> 12/19(äº”) 13:00~14:30</p>
                            <p><strong>åœ°é»:</strong> ç¬¬äº”é†«ç™‚å¤§æ¨“5æ¨“ 553 æœƒè­°å®¤</p>
                            <p><strong>ä¸»æŒ:</strong> æ•™å¸«åŸ¹è‚²ä¸­å¿ƒ éƒ­é€²æ¦®ä¸»ä»»</p>
                        </div>

                        <!-- æ–°å¢å­¸åˆ†å€å¡Š -->
                        <div class="mt-4 pt-3 border-t border-red-100 relative z-10">
                            <p class="font-bold text-black mb-2 text-base">å­¸åˆ†èªè­‰ï¼š</p>
                            <ul class="text-black text-base space-y-1">
                                <li class="flex items-start"><span class="mr-2 text-red-500">â€¢</span>CFDæ ¸å¿ƒèª²ç¨‹10é»</li>
                                <li class="flex items-start"><span class="mr-2 text-red-500">â€¢</span>ç§‘éƒ¨å¤–æ•™å­¸ç¸¾æ•ˆç©åˆ†</li>
                                <li class="flex items-start"><span class="mr-2 text-red-500">â€¢</span>è‡¨åºŠæ•™å¸«èªè­‰Bé¡ã€Œå…­å¤§æ ¸å¿ƒã€1å­¸åˆ†</li>
                                <li class="flex items-start"><span class="mr-2 text-red-500">â€¢</span>è‡¨åºŠæ•™å¸«èªè­‰ã€Œé€²éšã€1å­¸åˆ†</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- æµ·å ±å¼µè²¼å±•ç¤º å¡ç‰‡ -->
                    <div class="bg-white p-5 rounded-2xl shadow-md border-l-4 border-amber-500 relative overflow-hidden group">
                        <div class="absolute right-0 top-0 opacity-10 transform translate-x-4 -translate-y-4 group-hover:scale-110 transition-transform">
                            <span class="text-9xl">ğŸ–¼ï¸</span>
                        </div>
                        <h3 class="text-lg font-bold text-amber-700 mb-2 flex items-center relative z-10">
                            <span class="mr-2">ğŸ–¼ï¸</span>æµ·å ±å¼µè²¼å±•ç¤º
                        </h3>
                        <p class="text-amber-500 text-lg font-bold uppercase tracking-wider mb-3">â˜… å…± 39 ç¯‡ç²çè«–æ–‡åŒæ­¥å±•å‡º â˜…</p>
                        <div class="text-black text-base space-y-1 relative z-10">
                            <p><strong>æœŸé–“:</strong> 12/16 â€“ 12/31</p>
                            <p><strong>åœ°é»:</strong> ç¬¬äº”é†«ç™‚å¤§æ¨“ 5 æ¨“å±•ç¤ºå€</p>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- å³å´æ¬„ä½: æŸ¥è©¢èˆ‡åå–®ç¸½è¦½ (ä½” 8/12) -->
            <div class="lg:col-span-8 space-y-8">
                
                <!-- ğŸ… å—çé€šçŸ¥èˆ‡æ„é¡˜å›è¦† -->
                <div class="bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden">
                    <div class="bg-gradient-to-r from-fuchsia-600 to-purple-700 p-6 text-white relative overflow-hidden">
                        <div class="absolute -right-10 -top-10 opacity-20">
                            <span class="text-9xl">ğŸ…</span>
                        </div>
                        <h2 class="text-2xl font-bold flex items-center relative z-10">
                            <span class="bg-white/20 p-2 rounded-lg mr-3 backdrop-blur-sm">ğŸ…</span>
                            å—çé€šçŸ¥èˆ‡æŸ¥è©¢
                        </h2>
                        <p class="mt-2 text-fuchsia-100 relative z-10 max-w-xl leading-relaxed">
                            æ­å–œæ‚¨æ–¼æœ¬æ¬¡è«–æ–‡è©•é¸ä¸­è¡¨ç¾å„ªç•°ï¼<br>
                            è«‹ä½¿ç”¨ä¸‹æ–¹è¡¨å–®æŸ¥è©¢æ‚¨çš„ç²çç‹€æ…‹ä¸¦å›è¦†å‡ºå¸­æ„é¡˜ã€‚
                        </p>
                    </div>

                    <div class="p-6 md:p-8">
                        <!-- é€šçŸ¥ç´°ç¯€ -->
                        <div class="bg-red-50 border border-red-100 rounded-xl p-5 mb-8 flex flex-col md:flex-row gap-4 items-start">
                            <div class="bg-red-100 text-red-600 p-3 rounded-full shrink-0">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" /></svg>
                            </div>
                            <div>
                                <h4 class="font-bold text-red-800 text-2xl mb-3">èª æ‘¯é‚€è«‹ç²çè€…å…±åŒå‡ºå¸­å—ç</h4>
                                <ul class="text-black space-y-2 text-lg">
                                    <li class="flex items-start md:items-center"><span class="w-16 font-bold text-black shrink-0">æœƒè­°:</span> 12æœˆä»½é†«å­¸æ•™è‚²å§”å“¡æœƒè­°</li>
                                    <li class="flex items-start md:items-center"><span class="w-16 font-bold text-black shrink-0">æ—¥æœŸ:</span> <span class="font-bold text-red-600">12/10(ä¸‰) 12:20</span></li>
                                    <li class="flex items-start md:items-center"><span class="w-16 font-bold text-black shrink-0">é›†åˆ:</span> ç¬¬äº”é†«ç™‚å¤§æ¨“5æ¨“ 552 æœƒè­°å®¤å¤–</li>
                                    <li class="flex items-start md:items-center"><span class="w-16 font-bold text-black shrink-0">å‚™è¨»:</span> è«‹ç©¿è‘—å·¥ä½œæœ</li>
                                </ul>
                            </div>
                        </div>

                        <!-- æŸ¥è©¢è¡¨å–® -->
                        <form id="awardForm" class="space-y-4 mb-6">
                            <label for="personnelId" class="block text-lg font-bold text-slate-700 tracking-wide">
                                è«‹è¼¸å…¥ç²çè€…äººäº‹è™Ÿï¼Œå›è¦†æ˜¯å¦èƒ½å‡ºå¸­å—ç
                            </label>
                            <div class="flex flex-col sm:flex-row gap-3">
                                <input type="text" id="personnelId" name="personnelId" required
                                       class="flex-1 p-3.5 border border-slate-300 rounded-xl text-lg focus:outline-none focus:ring-2 focus:ring-fuchsia-500 focus:border-fuchsia-500 transition-shadow bg-slate-50 focus:bg-white"
                                       placeholder="ä¾‹å¦‚: A12345">
                                <button type="submit"
                                        class="px-8 py-3.5 bg-fuchsia-600 text-white font-bold rounded-xl hover:bg-fuchsia-700 active:bg-fuchsia-800 transition-colors shadow-lg shadow-fuchsia-200 flex items-center justify-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>
                                    æŸ¥è©¢è³‡æ–™
                                </button>
                            </div>
                        </form>

                        <!-- æŸ¥è©¢çµæœé¡¯ç¤ºå€åŸŸ -->
                        <div id="searchResult" class="hidden rounded-xl border p-5 transition-all duration-300">
                            <!-- JS å‹•æ…‹å¡«å…¥ -->
                        </div>
                    </div>
                </div>

                <!-- ğŸ‰ ç²çåå–®ç¸½è¦½ -->
                <div class="bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden">
                    <div class="p-6 border-b border-slate-100 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-slate-50/50">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800 flex items-center">
                                <span class="text-2xl mr-2">ğŸ‰</span> ç²çåå–®ç¸½è¦½
                            </h2>
                            <p class="text-slate-500 mt-1 text-lg">é»æ“Šä¸‹æ–¹çµ„åˆ¥åç¨±å±•é–‹è©³ç´°åå–®</p>
                        </div>
                        <div class="bg-white px-4 py-2 rounded-full border border-slate-200 text-lg font-bold text-slate-600 shadow-sm">
                            å…± 39 ç¯‡ç²çè«–æ–‡
                        </div>
                    </div>
                    
                    <div id="awardsContainer" class="p-6 space-y-3 bg-white">
                        <!-- åå–®å°‡ç”± JavaScript å‹•æ…‹æ’å…¥æ­¤è™• -->
                        <div class="animate-pulse space-y-3">
                            <div class="h-14 bg-slate-100 rounded-xl"></div>
                            <div class="h-14 bg-slate-100 rounded-xl"></div>
                            <div class="h-14 bg-slate-100 rounded-xl"></div>
                        </div>
                    </div>
                </div>

            </div>
        </main>

        <!-- é å°¾æ¨£å¼èª¿æ•´ï¼šæ”¹ç‚ºæ·±ç±³è‰²åº•è‰² -->
        <footer class="mt-16 text-center text-slate-700 text-base py-8 bg-[#e0d6c8] rounded-2xl shadow-sm">
            <div class="space-y-2">
                <p class="font-bold">å¦‚æœ‰ç–‘å•è«‹ä¾†é›»æˆ–ä¾†ä¿¡è©¢å•ï¼Œè¬è¬</p>
                <p>
                    <a href="mailto:b20715@mail.chimei.org.tw" class="hover:text-fuchsia-700 transition-colors font-medium">ğŸ“§ b20715@mail.chimei.org.tw</a>
                </p>
                <p class="font-medium">ğŸ“ 06-2812811 åˆ†æ©Ÿ 57439 æ•™å­¸éƒ¨ è©©èŠ¸</p>
            </div>
        </footer>
    </div>

    <!-- JavaScript é‚è¼¯ -->
    <script>
        // Apps Script éƒ¨ç½²ç¶²å€ (å·²æ›´æ–°ç‚ºæœ€æ–°ç‰ˆæœ¬)
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbx69XAVQROov5SVcn7i9H4GSvIn0DroV9ne04O_naZYqcs-usSfUe5-8LeZrZti6mOa/exec';
        
        // çµ„åˆ¥æ¨£å¼è¨­å®š (æ–°å¢ highlight é¡è‰²)
        const groupStyles = {
            "è—¥äº‹çµ„": { bg: "bg-red-50", hover: "hover:bg-red-100", border: "border-red-200", text: "text-red-800", badge: "bg-red-100 text-red-700", highlight: "text-red-600" },
            "é†«äº‹æ”¾å°„çµ„": { bg: "bg-amber-50", hover: "hover:bg-amber-100", border: "border-amber-200", text: "text-amber-800", badge: "bg-amber-100 text-amber-700", highlight: "text-amber-600" },
            "é†«äº‹æª¢é©—çµ„": { bg: "bg-emerald-50", hover: "hover:bg-emerald-100", border: "border-emerald-200", text: "text-emerald-800", badge: "bg-emerald-100 text-emerald-700", highlight: "text-emerald-600" },
            "è­·ç†çµ„": { bg: "bg-blue-50", hover: "hover:bg-blue-100", border: "border-blue-200", text: "text-blue-800", badge: "bg-blue-100 text-blue-700", highlight: "text-blue-600" },
            "ç‡Ÿé¤Šçµ„": { bg: "bg-purple-50", hover: "hover:bg-purple-100", border: "border-purple-200", text: "text-purple-800", badge: "bg-purple-100 text-purple-700", highlight: "text-purple-600" },
            "å‘¼å¸æ²»ç™‚çµ„": { bg: "bg-orange-50", hover: "hover:bg-orange-100", border: "border-orange-200", text: "text-orange-800", badge: "bg-orange-100 text-orange-700", highlight: "text-orange-600" },
            "è½åŠ›/ç‰©ç†æ²»ç™‚/è·èƒ½æ²»ç™‚/è‡¨åºŠå¿ƒç†/èªè¨€æ²»ç™‚çµ„": { bg: "bg-slate-50", hover: "hover:bg-slate-100", border: "border-slate-200", text: "text-slate-800", badge: "bg-slate-200 text-slate-700", highlight: "text-slate-600" }
        };

        // å®Œæ•´ç²çè³‡æ–™ (ç”¨æ–¼é è¨­å±•ç¤ºåˆ—è¡¨ï¼Œå¯¦éš›æœå°‹é€é GAS)
        const allAwardsData = [
            { id: "961108", group: "è—¥äº‹çµ„", rank: "ç¬¬ä¸€å", bonus: "4000å…ƒ", dept: "è—¥åŠ‘éƒ¨", author: "æç¾å¨Ÿ", position: "å°çµ„é•·", thesis: "è—¥å¸«åˆ©ç”¨ã€ŒA+è—¥å¸«ã€ç³»çµ±å„ªåŒ–è‡¨åºŠè—¥äº‹ç…§è­·çš„æ•ˆèƒ½" },
            { id: "560904", group: "è—¥äº‹çµ„", rank: "ç¬¬äºŒå", bonus: "3000å…ƒ", dept: "è—¥åŠ‘éƒ¨", author: "å‚…æŸæ†²", position: "è—¥å¸«", thesis: "é‹ç”¨è‡ªå‹•åŒ–æµç¨‹æ©Ÿå™¨äººæ”¹å–„ç®¡åˆ¶è—¥å“ç®¡ç†ä½œæ¥­ â€“ ä»¥æŸé†«å­¸ä¸­å¿ƒç‚ºä¾‹" },
            { id: "920422", group: "è—¥äº‹çµ„", rank: "ç¬¬ä¸‰å", bonus: "2000å…ƒ", dept: "è—¥åŠ‘éƒ¨", author: "æœ±éº—éˆ´", position: "ç¸½è—¥å¸«", thesis: "æ‡‰ç”¨ Power BI æ–¼é†«é™¢æ•¸æ“šç®¡ç†ä¹‹æˆæ•ˆè©•ä¼°" },
            { id: "961108", group: "è—¥äº‹çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è—¥åŠ‘éƒ¨", author: "æç¾å¨Ÿ", position: "å°çµ„é•·", thesis: "è—¥å¸«ä»‹å…¥é™ä½å¸¸è¦æ‰‹è¡“å¾ŒæŠ—è¡€æ “è—¥ç‰©éºæ¼åŠ å›çš„æ¯”ä¾‹" },
            { id: "940833", group: "è—¥äº‹çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è—¥åŠ‘éƒ¨", author: "å¾ç§‰è£•", position: "çµ„é•·", thesis: "å»ºç½®ä½é™¢è™•æ–¹é›»å­å¯©æ ¸ç³»çµ±ä¹‹æˆæ•ˆåˆæ¢" },
            { id: "A61232", group: "è—¥äº‹çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è—¥åŠ‘éƒ¨", author: "è¨±æ™‰ç‘‹", position: "è—¥å¸«", thesis: "Effectiveness and Safety of BEAC vs BEAM Conditioning Regimens in Lymphoma Patients: A Systematic Review and Meta-Analysis" },
            { id: "A208F1", group: "è—¥äº‹çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è—¥åŠ‘éƒ¨", author: "èŠ±é€¸èŒ—", position: "è—¥å¸«", thesis: "ç³»çµ±æ€§æ–‡ç»å›é¡§èˆ‡çµ±åˆåˆ†æï¼šæ¢è¨Tenofovir alafenamideç”¨æ–¼æ…¢æ€§Bå‹è‚ç‚æ‚£è€…å…¶è¡€è„‚æ•¸æ“šçš„å½±éŸ¿" },
            { id: "950924", group: "è—¥äº‹çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è—¥åŠ‘éƒ¨", author: "å³ä½³ç’‡", position: "çµ„é•·", thesis: "åˆ†æå…©ç¨®PARPæŠ‘åˆ¶åŠ‘æ²»ç™‚åµå·¢ç™Œä¹‹å®‰å…¨æ€§è©•ä¼°" },
            { id: "840931", group: "é†«äº‹æ”¾å°„çµ„", rank: "ç¬¬ä¸€å", bonus: "4000å…ƒ", dept: "æ”¾å°„è¨ºæ–·ç§‘æ€¥é‡ç—‡å½±åƒçµ„", author: "é»ƒå»ºä¸­", position: "çµ„é•·", thesis: "å¥‡ç¾é†«é™¢é†«äº‹æ”¾å°„è·é¡å…¨äººç…§è­·æ•™å­¸æˆæ•ˆåˆ†ææ¢" },
            { id: "A20413", group: "é†«äº‹æ”¾å°„çµ„", rank: "ç¬¬äºŒå", bonus: "3000å…ƒ", dept: "æ”¾å°„è…«ç˜¤éƒ¨", author: "é»ƒçŸ¥ç‘©", position: "é†«äº‹æ”¾å°„å¸«", thesis: "æ¢è¨ä»¥è¨˜æ†¶åºŠå€¼è¼”åŠ©ä¹³ç™Œå°ä½å¹«åŠ©ä¹‹ç¶“é©—åˆ†äº«" },
            { id: "860642", group: "é†«äº‹æ”¾å°„çµ„", rank: "ç¬¬ä¸‰å", bonus: "2000å…ƒ", dept: "æ”¾å°„è¨ºæ–·ç§‘é›»è…¦æ–·å±¤ç£æŒ¯é€ å½±çµ„", author: "é¾ä½³éµ¬", position: "é†«äº‹æ”¾å°„å¸«", thesis: "åˆ©ç”¨éœæ¯æ…‹åŠŸèƒ½æ€§ç£æŒ¯é€ å½±(rsf MRI)ç ”ç©¶é é˜²æ²»ç™‚å°æ…¢æ€§åé ­ç—›æ‚£è€…å¤§è…¦çµæ§‹å’ŒåŠŸèƒ½çš„å½±éŸ¿" },
            { id: "810641", group: "é†«äº‹æ”¾å°„çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "å½±åƒé†«å­¸éƒ¨", author: "ä¹ˆç…¥å¿ ", position: "æŠ€è¡“ä¸»ä»»", thesis: "The Role of Information Systems in Preventing Allergic Reactions to Contrast Medium and Evaluating Adverse Incidents in MRI" },
            { id: "990422", group: "é†«äº‹æª¢é©—çµ„", rank: "ç¬¬ä¸€å", bonus: "4000å…ƒ", dept: "è‡¨åºŠç—…ç†éƒ¨", author: "å‘¨ä¿®éŸ³", position: "çµ„é•·", thesis: "å°å…¥AIæ™ºèƒ½åˆ¤è®€ç³»çµ± BD Urine Culture Appä¹‹è‡¨åºŠæ•ˆèƒ½èˆ‡æº–ç¢ºåº¦åˆ†æ" },
            { id: "B30331", group: "é†«äº‹æª¢é©—çµ„", rank: "ç¬¬äºŒå", bonus: "3000å…ƒ", dept: "è‡¨åºŠç—…ç†éƒ¨", author: "é™³éœå¦‚", position: "çµ„é•·", thesis: "The clinical value of HLA antibody testing in strategies for kidney transplant patients" },
            { id: "B10550", group: "é†«äº‹æª¢é©—çµ„", rank: "ç¬¬ä¸‰å", bonus: "2000å…ƒ", dept: "ç²¾æº–é†«å­¸æ ¸å¿ƒå¯¦é©—å®¤", author: "æ´ªå­ŸèŠ¸", position: "é«˜éš(â…¡)é†«æª¢å¸«", thesis: "The Role of ALK IHC in the Era of Advanced Molecular Diagnostics for NSCLC" },
            { id: "B10108", group: "é†«äº‹æª¢é©—çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è‡¨åºŠç—…ç†éƒ¨", author: "è¬ä½³å€«", position: "ä¸­éš(â…¡)é†«æª¢å¸«", thesis: "å„ªåŒ–æŠ—é…¸èŒæŸ“è‰²æµç¨‹ï¼šé«˜åƒ¹æ•¸è¢å…‰æŸ“è‰²çµæœçœç•¥Ziehl-NeelsenæŸ“è‰²æ³•è¤‡æŸ“ä¹‹å¯è¡Œæ€§è©•ä¼°" },
            { id: "B20206", group: "é†«äº‹æª¢é©—çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è‡¨åºŠç—…ç†éƒ¨", author: "é»ƒéœå¦", position: "åˆéšé†«æª¢å¸«", thesis: "Assessment of Glucose Meter Acurracy in Hospital" },
            { id: "990129", group: "é†«äº‹æª¢é©—çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "ç²¾æº–é†«å­¸æ ¸å¿ƒå¯¦é©—å®¤", author: "é‚±æ„çŠ", position: "é†«å­¸å°ˆå“¡", thesis: "A Novel MET Intron 13 Mutation Associated with Exon 14 Skipping: A Case Study of Multi-Platform Testing" },
            { id: "B00628", group: "é†«äº‹æª¢é©—çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "ç²¾æº–é†«å­¸æ ¸å¿ƒå¯¦é©—å®¤", author: "è©¹å¤æŒ¯", position: "é«˜éš(â… )é†«æª¢å¸«", thesis: "Development and validation of an LCâ€“MS/MS method for quantitation of myo-inositol in human plasma" },
            { id: "8407B2", group: "è­·ç†çµ„", rank: "ç¬¬ä¸€å", bonus: "4000å…ƒ", dept: "è­·ç†éƒ¨", author: "å¾å¯Œç¾", position: "ç£å°", thesis: "ç”¢å‰è¡›æ•™åœ°åœ–æœ‰è²æ›¸" },
            { id: "930969", group: "è­·ç†çµ„", rank: "ç¬¬äºŒå", bonus: "3000å…ƒ", dept: "è­·ç†éƒ¨", author: "æç©ä¿", position: "ç£å°", thesis: "ä»¥ä½¿ç”¨è€…ç‚ºä¸­å¿ƒçš„æ…¢æ€§å‚·å£ç®¡ç†ç³»çµ±ï¼Œæ”¯æŒåœ˜éšŠæ•´åˆèˆ‡ç—…äººåƒèˆ‡" },
            { id: "920429", group: "è­·ç†çµ„", rank: "ç¬¬ä¸‰å", bonus: "2000å…ƒ", dept: "9Aç—…æˆ¿", author: "æ¥Šç¦®è¬™", position: "è­·ç†é•·", thesis: "æå‡æ•´åˆç—…æˆ¿é«˜é½¡è­«å¦„ç…§è­·æˆæ•ˆ" },
            { id: "840626", group: "è­·ç†çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è­·ç†éƒ¨", author: "ææ€¡ç", position: "ç£å°", thesis: "Predicting Surgical Patientsâ€™Risk of Pressure Injuries Using Artificial Intelligence: A Preliminary Analysis" },
            { id: "A60564", group: "è­·ç†çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è­·ç†éƒ¨", author: "é‚±æ—…æš", position: "è­·ç†å¸«(N4)", thesis: "Developing a Portable \"Learning Portfolio\": An Initial Exploration of e-Portfolio for the Two-Year Post Graduate Nurse Training Program" },
            { id: "A60564", group: "è­·ç†çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è­·ç†éƒ¨", author: "é‚±æ—…æš", position: "è­·ç†å¸«(N4)", thesis: "é‹ç”¨POWER BIæ•¸ä½è¦–è¦ºåŒ–å·¥å…·å±•ç¾è­·ç†æ•™è‚²èˆ‡å¸«è³‡åŸ¹è‚²æ•™å­¸æˆæ•ˆä¹‹æ¢è¨" },
            { id: "B00787", group: "è­·ç†çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "è­·ç†éƒ¨", author: "é™³å²‘ä½©", position: "å°ˆå“¡", thesis: "EXPLORING THE LIVED EXPERIENCES OF DEMENTIA PATIENTS PARTICIPATING IN THE DIVERSITY CREATIVE PROGRAM: A MIXED-METHODS STUDY" },
            { id: "9903J7", group: "è­·ç†çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "9Bç—…æˆ¿", author: "é­å˜‰æ…§", position: "è­·ç†é•·(N4)", thesis: "åŸºå±¤è­·ç†ä¸»ç®¡å·¥ä½œå£“åŠ›ã€å› æ‡‰ç­–ç•¥èˆ‡è·æ¥­ç–²å‹ä¹‹é—œä¿‚ç ”ç©¶" },
            { id: "960906", group: "è­·ç†çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "3BåŠ è­·ç—…æˆ¿", author: "æè€˜é’", position: "é«˜éšè­·ç†å¸«(N4)", thesis: "é‹ç”¨MOREA2Fçµ„åˆå¼ç…§è­·æå‡åŠ è­·ç§‘ç³»è­«å¦„ç…§è­·å“è³ª" },
            { id: "911032", group: "è­·ç†çµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "3BåŠ è­·ç—…æˆ¿", author: "è”¡ç“Šæ…§", position: "é«˜éšè­·ç†å¸«(N4)", thesis: "é«”å¤–èˆ‡å¸¸è¦æ€§å¿ƒè‚ºå¾©ç”¦å°åˆ°é™¢å‰å¿ƒè‚ºåŠŸèƒ½åœæ­¢ä¹‹ç¥ç¶“ç³»çµ±å½±éŸ¿ï¼šç³»çµ±æ€§æ–‡ç»å›é¡§èˆ‡çµ±åˆåˆ†æ" },
            { id: "B40328", group: "ç‡Ÿé¤Šçµ„", rank: "ç¬¬ä¸€å", bonus: "4000å…ƒ", dept: "ç‡Ÿé¤Šç§‘", author: "å³æ”¿å½¥", position: "ç‡Ÿé¤Šå¸«(D2)", thesis: "ç³–å°¿ç—…æ‚£è€…ä½µæœ‰é‹…ç¼ºä¹èˆ‡åš´é‡å¿ƒè…ä¸è‰¯äº‹ä»¶ä¹‹é—œè¯æ€§" },
            { id: "A91111", group: "ç‡Ÿé¤Šçµ„", rank: "ç¬¬äºŒå", bonus: "3000å…ƒ", dept: "ç‡Ÿé¤Šç§‘", author: "è¶™è‹”å›", position: "ç‡Ÿé¤Šå¸«(D4)", thesis: "è¡“å¾ŒåŠ é€Ÿåº·å¾©(ERASï¼‰å°å¤§è…¸ç›´è…¸ç™Œæ‚£è€…è¡“å¾Œè…¸é“ä½µç™¼ç—‡çš„å½±éŸ¿åŠå…¶ç›¸é—œå› ç´ åˆ†æ" },
            { id: "A91186", group: "ç‡Ÿé¤Šçµ„", rank: "ç¬¬ä¸‰å", bonus: "2000å…ƒ", dept: "ç‡Ÿé¤Šç§‘", author: "å³å®œî›¿", position: "ç‡Ÿé¤Šå¸«(D2)", thesis: "å°å—æŸé†«å­¸ä¸­å¿ƒé«”é‡ç®¡ç†é–€è¨ºçµåˆé†«ç—…å…±äº«æ±ºç­–ä¹‹æ¸›é‡æˆæœåˆ†æ" },
            { id: "960326", group: "ç‡Ÿé¤Šçµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "ç‡Ÿé¤Šç§‘", author: "ç‹é€¸å©·", position: "ä»£ç†çµ„é•·", thesis: "ç¬¬ä¸€å‹ç³–å°¿ä¼´æœ‰é…®é…¸ä¸­æ¯’éæŒçºŒç‡Ÿé¤Šç…§è­·å››å¹´è¿½è¹¤çµæœ-ç—…ä¾‹å ±å‘Š" },
            { id: "B00736", group: "ç‡Ÿé¤Šçµ„", rank: "ä½³ä½œ", bonus: "1000å…ƒ", dept: "ç‡Ÿé¤Šç§‘", author: "æ—çˆæ±¶", position: "ç‡Ÿé¤Šå¸«(D4)", thesis: "CGMæ‡‰ç”¨åœ¨ç‡Ÿé¤Šé…æ–¹æ¢è¨ä¹‹å€‹æ¡ˆå ±å‘Š" },
            { id: "920709", group: "å‘¼å¸æ²»ç™‚çµ„", rank: "ç¬¬ä¸€å", bonus: "4000å…ƒ", dept: "å‘¼å¸æ²»ç™‚ç§‘", author: "é«˜éº—å©·", position: "å‘¼å¸æ²»ç™‚å¸«(RRT2)", thesis: "å°ç£æ…¢æ€§é˜»å¡æ€§è‚ºç–¾ç—…æ‚£è€…ä¼´æœ‰ç¡çœ ç–¾ç—…ç™¼ç”Ÿè»Šç¦æ„å¤–ç›¸é—œå±éšªå› å­ä¹‹æ¢è¨" },
            { id: "990645", group: "å‘¼å¸æ²»ç™‚çµ„", rank: "ç¬¬äºŒå", bonus: "3000å…ƒ", dept: "å‘¼å¸æ²»ç™‚ç§‘", author: "æ›¾æ¡‚ç²", position: "å‘¼å¸æ²»ç™‚å¸«(RRT3)", thesis: "Prognostic Analysis of Palliative Extubation in Long-Term Mechanically Ventilated Patients" },
            { id: "B00045", group: "è½åŠ›/ç‰©ç†æ²»ç™‚/è·èƒ½æ²»ç™‚/è‡¨åºŠå¿ƒç†/èªè¨€æ²»ç™‚çµ„", rank: "ç¬¬ä¸€å", bonus: "4000å…ƒ", dept: "å¾©å¥éƒ¨èªè¨€æ²»ç™‚çµ„", author: "è”¡å®œåº­", position: "èªè¨€æ²»ç™‚å¸«", thesis: "ä½¿ç”¨TheraBiteå£è…”é–‰åˆè¨“ç·´å™¨æ–¼ç‰™é—œç·Šé–‰çš„é ­é ¸ç™Œæ‚£è€…çš„æˆæ•ˆ:ç³»çµ±æ€§å›é¡§åŠçµ±åˆåˆ†æ" },
            { id: "B20349", group: "è½åŠ›/ç‰©ç†æ²»ç™‚/è·èƒ½æ²»ç™‚/è‡¨åºŠå¿ƒç†/èªè¨€æ²»ç™‚çµ„", rank: "ç¬¬äºŒå", bonus: "3000å…ƒ", dept: "æ¨¹æ—é™¢å€", author: "è¬ç®å¦", position: "è‡¨åºŠå¿ƒç†å¸«", thesis: "çµæ§‹åŒ–è€ƒæ ¸è¡¨èˆ‡AIæ•´åˆæå‡è‡¨åºŠå¿ƒç†æ•™å­¸æ•ˆæœä¹‹æ¢ç´¢æ€§ç ”ç©¶" },
            { id: "B10119", group: "è½åŠ›/ç‰©ç†æ²»ç™‚/è·èƒ½æ²»ç™‚/è‡¨åºŠå¿ƒç†/èªè¨€æ²»ç™‚çµ„", rank: "ç¬¬ä¸‰å", bonus: "2000å…ƒ", dept: "å¾©å¥éƒ¨ç‰©ç†æ²»ç™‚çµ„", author: "æä¾åº­", position: "çµ„é•·", thesis: "éª¨ç›†å¸¶å•å·åœ¨ç¹é«”ä¸­æ–‡æ—ç¾¤çš„è·¨æ–‡åŒ–é©æ‡‰æ€§åŠä¿¡æ•ˆåº¦é©—è­‰" }
        ];

        // è³‡æ–™åˆ†çµ„å‡½å¼
        function groupAwards(data) {
            return data.reduce((acc, award) => {
                const groupName = award.group;
                if (!acc[groupName]) acc[groupName] = [];
                acc[groupName].push(award);
                return acc;
            }, {});
        }

        // æ¸²æŸ“åå–®å‡½å¼
        function renderAwards(data) {
            const grouped = groupAwards(data);
            const container = document.getElementById('awardsContainer');
            container.innerHTML = ''; 

            Object.keys(grouped).forEach((groupName, index) => {
                const groupAwards = grouped[groupName];
                const styles = groupStyles[groupName] || { bg: "bg-gray-50", hover: "hover:bg-gray-100", border: "border-gray-200", text: "text-gray-800", badge: "bg-gray-200 text-gray-700", highlight: "text-gray-600" };
                
                const groupHtml = `
                    <div class="border ${styles.border} rounded-xl overflow-hidden transition-all duration-300 hover:shadow-md">
                        <button class="collapsible-toggle w-full p-4 flex justify-between items-center text-left ${styles.bg} ${styles.hover} transition-colors focus:outline-none"
                                aria-expanded="false" 
                                onclick="toggleCollapsible(this)">
                            <div class="flex items-center gap-3">
                                <span class="w-1.5 h-6 rounded-full ${styles.text.replace('text', 'bg')}"></span>
                                <h3 class="text-xl font-bold ${styles.text}">
                                    ${groupName}
                                </h3>
                                <span class="text-sm font-semibold px-2.5 py-0.5 rounded-full bg-white/60 text-gray-600 border border-gray-100">${groupAwards.length} ç¯‡</span>
                            </div>
                            <svg class="arrow-icon w-6 h-6 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                        
                        <div class="collapsible-content bg-white">
                            <div class="divide-y divide-gray-100">
                                ${groupAwards.map(award => {
                                    let medalIcon = '';
                                    let rankClass = 'text-gray-600 bg-gray-100';
                                    if(award.rank.includes('ç¬¬ä¸€å')) { medalIcon = 'ğŸ¥‡'; rankClass = 'text-yellow-700 bg-yellow-100'; }
                                    else if(award.rank.includes('ç¬¬äºŒå')) { medalIcon = 'ğŸ¥ˆ'; rankClass = 'text-gray-700 bg-slate-200'; }
                                    else if(award.rank.includes('ç¬¬ä¸‰å')) { medalIcon = 'ğŸ¥‰'; rankClass = 'text-amber-800 bg-amber-100'; }
                                    else { medalIcon = 'ğŸ–ï¸'; rankClass = 'text-fuchsia-700 bg-fuchsia-50'; }

                                    return `
                                    <div class="p-5 hover:bg-slate-50 transition-colors group">
                                        <div class="flex flex-col md:flex-row md:justify-between md:items-start gap-3">
                                            <div class="flex-1">
                                                <div class="flex items-center flex-wrap gap-2 mb-2">
                                                    <span class="inline-flex items-center px-3 py-1 rounded text-sm font-bold ${rankClass}">
                                                        ${medalIcon} ${award.rank}
                                                    </span>
                                                    <!-- çé‡‘æ¨£å¼ä¿®æ­£ï¼šä½¿ç”¨çµ„åˆ¥é¡è‰² -->
                                                    <span class="inline-block md:hidden px-3 py-1 rounded-full text-sm font-bold ${styles.badge} border border-opacity-20">
                                                        çé‡‘ ${award.bonus}
                                                    </span>
                                                </div>
                                                <h4 class="text-xl font-bold text-slate-800 leading-snug group-hover:text-fuchsia-700 transition-colors mb-2">
                                                    ${award.thesis}
                                                </h4>
                                                <div class="flex flex-wrap items-center gap-4 text-base md:text-lg text-slate-500">
                                                    <span class="flex items-center gap-1">
                                                        <svg class="w-5 h-5 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>
                                                        <!-- ç§»é™¤æ‹¬è™Ÿ -->
                                                        ${award.author} <span class="text-slate-400 text-sm">${award.position}</span>
                                                    </span>
                                                    <span class="flex items-center gap-1">
                                                        <svg class="w-5 h-5 text-slate-400" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" /></svg>
                                                        ${award.dept}
                                                    </span>
                                                </div>
                                            </div>
                                            <div class="shrink-0 hidden md:block">
                                                <!-- çé‡‘æ¨£å¼ä¿®æ­£ï¼šä½¿ç”¨çµ„åˆ¥é¡è‰² -->
                                                <span class="inline-block px-3 py-1 rounded-full text-sm font-bold ${styles.badge} border border-opacity-20">
                                                    çé‡‘ ${award.bonus}
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                `}).join('')}
                            </div>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', groupHtml);
            });
        }

        // æ‘ºç–Šé¸å–®åˆ‡æ›
        function toggleCollapsible(button) {
            const isExpanded = button.getAttribute('aria-expanded') === 'true';
            button.setAttribute('aria-expanded', !isExpanded);
        }

        // é¡¯ç¤ºæŸ¥è©¢çµæœ
        function displaySearchResults(results) {
            const resultDiv = document.getElementById('searchResult');
            resultDiv.classList.remove('hidden', 'bg-red-50', 'border-red-200', 'bg-green-50', 'border-green-200', 'bg-yellow-50', 'border-yellow-200');
            resultDiv.innerHTML = '';
            
            if (!results || results.length === 0) {
                resultDiv.classList.add('block', 'bg-yellow-50', 'border-yellow-200');
                resultDiv.innerHTML = `
                    <div class="flex items-center gap-3 text-yellow-800">
                        <svg class="w-8 h-8 shrink-0" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" /></svg>
                        <div>
                            <p class="font-bold text-xl">æŸ¥ç„¡è³‡æ–™</p>
                            <p class="text-lg opacity-80">è«‹æª¢æŸ¥æ‚¨è¼¸å…¥çš„äººäº‹è™Ÿç¢¼æ˜¯å¦æ­£ç¢ºã€‚</p>
                        </div>
                    </div>
                `;
                return;
            }

            const totalCount = results.length;
            const authorNames = [...new Set(results.map(r => r.ä½œè€…))].join('ã€');
            
            resultDiv.classList.add('block', 'bg-green-50', 'border-green-200');
            resultDiv.innerHTML = `
                <div class="mb-4 flex items-center gap-2 text-green-800 border-b border-green-200 pb-2">
                    <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                    <p class="font-bold text-xl">æŸ¥è©¢æˆåŠŸï¼${authorNames}ï¼Œæ‚¨å…±æœ‰ ${totalCount} ç­†ç²çè³‡è¨Šï¼š</p>
                </div>
                <div class="space-y-4">
                    ${results.map(data => {
                        const style = groupStyles[data.çµ„åˆ¥] || { border: "border-gray-200", text: "text-gray-800", badge: "bg-gray-100 text-gray-600", highlight: "text-gray-600" };
                        
                        let actionArea = '';
                        if (data.status && data.status.trim() !== '') {
                            // å·²æœ‰å›è¦†ç‹€æ…‹ï¼Œé¡¯ç¤ºç‹€æ…‹æ–‡å­—
                            let statusColor = 'text-gray-700';
                            let statusIcon = '';
                            let displayStatusText = data.status; // é è¨­ä½¿ç”¨è³‡æ–™åº«çš„ç‹€æ…‹

                            if (data.status.includes('ä¸å…‹')) {
                                statusColor = 'text-red-600 bg-red-50 border-red-100';
                                statusIcon = 'âŒ';
                            } else {
                                // è‹¥ç‹€æ…‹æ˜¯æ­£å‘çš„ï¼Œçµ±ä¸€é¡¯ç¤ºç‚ºã€Œå¯å‡ºå¸­ã€
                                statusColor = 'text-green-600 bg-green-50 border-green-100';
                                statusIcon = 'âœ…';
                                if (displayStatusText === 'å‡ºå¸­' || displayStatusText === 'å¯å‡ºå¸­') displayStatusText = 'å¯å‡ºå¸­';
                            }

                            actionArea = `
                                <div class="mt-4 pt-4 border-t border-gray-100 flex justify-end items-center">
                                    <div class="px-4 py-2 rounded-lg border ${statusColor} flex items-center shadow-sm">
                                        <span class="mr-2 text-xl">${statusIcon}</span>
                                        <span class="text-lg font-bold">æ‚¨å·²å›è¦†ï¼š${displayStatusText}</span>
                                    </div>
                                </div>
                            `;
                        } else {
                            // å°šæœªå›è¦†ï¼Œé¡¯ç¤ºæŒ‰éˆ•
                            actionArea = `
                                <div class="mt-4 pt-4 border-t border-gray-100 flex flex-wrap gap-3 justify-end">
                                    <button onclick="updateAttendance('${data.äººäº‹è™Ÿ}', 'å¯å‡ºå¸­', this)" class="text-base font-medium text-white bg-green-600 hover:bg-green-700 px-6 py-2.5 rounded-lg transition-colors shadow-sm flex items-center disabled:opacity-50">
                                        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                                        æˆ‘å¯ä»¥å‡ºå¸­é ˜ç
                                    </button>
                                    <button onclick="updateAttendance('${data.äººäº‹è™Ÿ}', 'ä¸å…‹å‡ºå¸­', this)" class="text-base font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 border border-slate-200 px-6 py-2.5 rounded-lg transition-colors flex items-center disabled:opacity-50">
                                        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                                        ä¸å…‹å‡ºå¸­é ˜ç
                                    </button>
                                </div>
                            `;
                        }

                        return `
                            <div class="bg-white p-5 rounded-xl border-l-8 shadow-md ${style.border.replace('border', 'border-l')}">
                                <div class="flex justify-between items-start mb-2">
                                    <div class="flex items-center gap-2">
                                        <!-- çµ„åˆ¥èˆ‡æ’åæ¨£å¼çµ±ä¸€ -->
                                        <span class="text-lg font-bold px-3 py-1 rounded bg-slate-50 border border-gray-200 ${style.text}">${data.çµ„åˆ¥}</span>
                                        <span class="text-lg font-bold px-3 py-1 rounded bg-slate-50 border border-gray-200 ${style.text}">${data.rank}</span>
                                    </div>
                                    <!-- çé‡‘æ¨£å¼ä¿®æ­£ï¼šä½¿ç”¨çµ„åˆ¥é¡è‰² -->
                                    <span class="font-bold text-xl ${style.highlight}">çé‡‘ ${data.çé‡‘}</span>
                                </div>
                                <h4 class="text-2xl font-bold text-slate-800 mb-2 leading-tight">${data.è«–æ–‡åç¨±}</h4>
                                <div class="flex flex-wrap items-center gap-3 text-lg text-slate-600 mb-4">
                                    <span>${data.ç§‘åˆ¥}</span>
                                    <span class="text-slate-300">â€¢</span>
                                    <!-- ç§»é™¤æ‹¬è™Ÿ -->
                                    <span class="font-medium">${data.ä½œè€…} ${data.è·ç¨±}</span>
                                </div>
                                ${actionArea}
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        // æ–°å¢ï¼šè™•ç†å›è¦†å‡ºå¸­æ„é¡˜çš„å‡½å¼
        async function updateAttendance(personnelId, status, btnElement) {
            // é˜²æ­¢é‡è¤‡é»æ“Š
            if (btnElement.disabled) return;
            const originalText = btnElement.innerHTML;
            btnElement.disabled = true;
            btnElement.innerHTML = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-current" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> è™•ç†ä¸­...`;

            try {
                // å»ºæ§‹ POST è«‹æ±‚çš„ bodyï¼Œä½¿ç”¨ x-www-form-urlencoded æ ¼å¼
                const formData = new URLSearchParams();
                formData.append('action', 'updateAttendance');
                formData.append('personnelId', personnelId);
                formData.append('status', status);

                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    body: formData,
                    // mode: 'cors' // GAS doPost é€šå¸¸éœ€è¦ corsï¼Œæˆ– no-cors ä½†ç„¡æ³•è®€å–å›æ‡‰ã€‚å»ºè­°ä¿ç•™é è¨­æˆ– cors
                });

                if (!response.ok) throw new Error('Network response was not ok');
                
                const result = await response.json();

                if (result.success) {
                    alert(`âœ… å·²æˆåŠŸç™»è¨˜ï¼š${status}`);
                    // é‡æ–°æŸ¥è©¢ä»¥æ›´æ–°ä»‹é¢é¡¯ç¤º (å–ä»£ç›´æ¥æ“ä½œ DOMï¼Œç¢ºä¿è³‡æ–™ä¸€è‡´æ€§)
                    // æˆ–è€…ç›´æ¥æ“ä½œ DOM éš±è—æŒ‰éˆ•é¡¯ç¤ºç‹€æ…‹æ–‡å­—
                    // é€™è£¡ç‚ºäº†ç°¡å–®ç›´æ¥æ›¿æ›æŒ‰éˆ•å€åŸŸç‚ºç‹€æ…‹æ–‡å­—
                    const parentDiv = btnElement.closest('.mt-4'); // æ‰¾åˆ°æŒ‰éˆ•å®¹å™¨
                    
                    let statusColor = 'text-gray-700';
                    let statusIcon = '';
                    if (status.includes('ä¸å…‹')) {
                        statusColor = 'text-red-600 bg-red-50 border-red-100';
                        statusIcon = 'âŒ';
                    } else {
                        statusColor = 'text-green-600 bg-green-50 border-green-100';
                        statusIcon = 'âœ…';
                    }

                    parentDiv.innerHTML = `
                        <div class="px-4 py-2 rounded-lg border ${statusColor} flex items-center shadow-sm">
                            <span class="mr-2 text-xl">${statusIcon}</span>
                            <span class="text-lg font-bold">æ‚¨å·²å›è¦†ï¼š${status}</span>
                        </div>
                    `;
                    // ä¿®æ”¹å°é½Šæ–¹å¼ç‚º flex items-center (å¦‚æœçˆ¶å±¤æ˜¯ flex justify-end)
                    parentDiv.classList.add('items-center');

                } else {
                    alert(`âŒ ç™»è¨˜å¤±æ•—ï¼š${result.message}`);
                    btnElement.disabled = false;
                    btnElement.innerHTML = originalText;
                }

            } catch (error) {
                console.error('Error:', error);
                alert('âŒ é€£ç·šéŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦ã€‚');
                btnElement.disabled = false;
                btnElement.innerHTML = originalText;
            }
        }

        // è™•ç†è¡¨å–®æäº¤
        async function handleFormSubmit(event) {
            event.preventDefault();
            const personnelId = document.getElementById('personnelId').value;
            const resultDiv = document.getElementById('searchResult');
            const inputId = String(personnelId).toUpperCase().trim();

            if (!inputId) return;

            // Loading ç‹€æ…‹
            resultDiv.classList.remove('hidden', 'bg-red-50', 'bg-green-50', 'bg-yellow-50');
            resultDiv.classList.add('block', 'bg-slate-50', 'border-slate-200');
            resultDiv.innerHTML = `
                <div class="flex items-center justify-center p-4 text-fuchsia-600">
                    <svg class="animate-spin -ml-1 mr-3 h-5 w-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                    <span class="font-bold">è³‡æ–™æŸ¥è©¢ä¸­ï¼Œè«‹ç¨å€™...</span>
                </div>
            `;

            const url = `${APPS_SCRIPT_URL}?personnelId=${encodeURIComponent(inputId)}`;
            const MAX_RETRIES = 3;

            for (let attempt = 1; attempt <= MAX_RETRIES; attempt++) {
                try {
                    const response = await fetch(url, {
                        method: 'GET',
                        mode: 'cors',
                        credentials: 'omit'
                    });

                    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);

                    const json = await response.json();
                    
                    if (json.success && json.data) {
                        displaySearchResults(json.data);
                        return;
                    } else {
                        displaySearchResults(null);
                        return;
                    }

                } catch (error) {
                    console.error(`Attempt ${attempt} failed:`, error);
                    if (attempt === MAX_RETRIES) {
                        resultDiv.classList.remove('bg-slate-50');
                        resultDiv.classList.add('bg-red-50', 'border-red-200');
                        resultDiv.innerHTML = `
                            <div class="p-2 text-red-700">
                                <p class="font-bold">âŒ é€£ç·šå¤±æ•—</p>
                                <p class="text-sm mt-1">ç„¡æ³•é€£æ¥åˆ°è³‡æ–™åº«ã€‚è«‹ç¢ºèªç¶²è·¯é€£ç·šæˆ–ç¨å¾Œå†è©¦ã€‚</p>
                                <p class="text-xs text-gray-500 mt-2">å¦‚æœæ‚¨æ˜¯é–‹ç™¼è€…ï¼šè«‹æª¢æŸ¥ Google Apps Script çš„ CORS è¨­å®šæˆ–æ¬Šé™ã€‚</p>
                            </div>
                        `;
                        return;
                    }
                    await new Promise(resolve => setTimeout(resolve, 1500));
                }
            }
        }

        // åˆå§‹åŒ–
        window.onload = function() {
            renderAwards(allAwardsData);
            const form = document.getElementById('awardForm');
            if (form) {
                form.addEventListener('submit', handleFormSubmit);
            }
        };
    </script>
</body>
</html>
